@model HR_Module_Proj.Models.MasterRoleVM
@{
		ViewData["Title"] = "Master Role";

}


<style>
	.auto-width-table {
		width: auto !important;
		table-layout: auto !important;
	}

		.auto-width-table th,
		.auto-width-table td {
			white-space: nowrap;
		}
</style>

<link href="~/Assets/fontawesome-free-6.7.2-web/css/all.min.css" rel="stylesheet" />


<div class="container py-4">
	<div style="display: flex; justify-content: space-between; align-items: center;">
		<h2 class="mb-3" style="margin: 0;">Master Role</h2>
		<button id="regBtn" type="button"
				onclick="toggleRegister()"
				class="btn btn-sm btn-outline-info" style="background-color:lightpink; color:black; cursor: pointer;">
			Register
		</button>
	</div>
	<hr style="border: 1px solid #ccc; margin: 2px 0; margin-bottom: 20px;">
	<div class="row g-3 justify-content-center align-items-center">
		<div class="col-md-6" id="form">
			<div class="card shadow-sm">
				<div class="card-body">
					<h3 id="formTitle" class="card-title">Add role</h3>
					<form asp-action="SaveAndUpdate" method="post">
						<input asp-for="role.Id" type="hidden" />

						<div class="mb-3">
							<label asp-for="role.RoleName" class="control-label m-1">Role</label>
							<input asp-for="role.RoleName" class="form-control" placeholder="Enter Role name" />
							<span asp-validation-for="role.RoleName" class="text-danger"></span>
						</div>

						<div class="mb-3">
							<label asp-for="role.ShortName" class="control-label m-1">Short Name</label>
							<input asp-for="role.ShortName" class="form-control" placeholder="Enter short name"/>
							<span asp-validation-for="role.ShortName" class="text-danger"></span>
						</div>

						<div class="form-group form-check col-1 m-4">
							<input asp-for="role.IsActive" class="form-check-input" />
							<label asp-for="role.IsActive" class="form-check-label">IsActive</label>
						</div>

						<div class="d-flex gap-2">
							<button id="submitBtn" type="submit" class="btn btn-primary">Save</button>
							<button type="button" class="btn btn-secondary" onclick="resetForm()">Reset</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<div class="col-md-8" id="register">
			<h3 id="tblTitle">Roles</h3>
			<table class="table table-striped table-bordered table-hover">
				<thead>
					<tr>
						<th>#</th>
						<th>Role Name</th>
						<th>Short Name</th>
						<th>Is Active</th>
						<th>Actions</th>
					</tr>
				</thead>
				<tbody>
					@{
						var SerialNo = 1;
					}
					@foreach (var item in Model.roles)
					{
						<tr data-id="@item.Id" data-rolename="@item.RoleName" data-shortname="@item.ShortName" data-isactive="@item.IsActive">
							<td>@SerialNo</td>
							<td>@item.RoleName</td>
							<td>@item.ShortName</td>
							<td>@(item.IsActive ? "Yes" : "No")</td>
							<td>
								<button type="button" class="btn btn-sm btn-info edit-btn"><i class="fa-regular fa-pen-to-square"></i></button>
								<form asp-action="Delete" asp-route-id="@item.Id" method="post" style="display:inline;">
									<button type="submit" class="btn btn-sm btn-danger"
											onclick="return confirm('Are you sure you want to delete this item?');">
										<i class="fa-regular fa-trash-can"></i>
									</button>
								</form>
							</td>
						</tr>
						SerialNo++;
					}
				</tbody>
			</table>
		</div>
	</div>

</div>

@section Scripts {
	<partial name="_ValidationScriptsPartial" />
	<script>
		function toggleRegister() {
		var name = document.getElementById('regBtn').innerText;
			if(name == 'Register'){
				$('#register').show();
				$('#form').hide();
				document.getElementById('regBtn').innerText = 'Form';
			}
			else{
				$('#register').hide();
				$('#form').show();
				document.getElementById('regBtn').innerText = 'Register';
			}
		}

		function resetForm() {
		document.querySelector('[name="role.Id"]').value = 0;
		document.querySelector('[name="role.RoleName"]').value = '';
		document.querySelector('[name="role.ShortName"]').value = '';
		document.querySelector('[name="role.IsActive"]').checked = true;
		document.getElementById('formTitle').innerText = 'Add role';
		document.getElementById('submitBtn').innerText = 'Save';
		}

		document.addEventListener("DOMContentLoaded", function(){
			toggleRegister();
		})

		document.querySelectorAll('.edit-btn').forEach(btn => {
		btn.addEventListener('click', function () {
		const tr = this.closest('tr');
		document.querySelector('[name="role.Id"]').value = tr.dataset.id;
		document.querySelector('[name="role.RoleName"]').value = tr.dataset.rolename;
		document.querySelector('[name="role.ShortName"]').value = tr.dataset.shortname;
		document.querySelector('[name="role.IsActive"]').checked = tr.dataset.isactive;
		document.getElementById('formTitle').innerText = 'Edit role';
		document.getElementById('submitBtn').innerText = 'Update';
		window.scrollTo({ top: 0, behavior: 'smooth' });
		toggleRegister();
		});
		});
	</script>
}
